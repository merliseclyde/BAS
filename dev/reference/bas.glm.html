<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Adaptive Sampling Without Replacement for Variable Selection in Generalized Linear Models — bas.glm • BAS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Adaptive Sampling Without Replacement for Variable Selection in Generalized Linear Models — bas.glm"><meta name="description" content="Sample with or without replacement from a posterior distribution on GLMs"><meta property="og:description" content="Sample with or without replacement from a posterior distribution on GLMs"><meta property="og:image" content="http://merliseclyde.github.io/BAS/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BAS</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.7.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/merliseclyde"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/merliseclyde/BAS"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian Adaptive Sampling Without Replacement for Variable Selection in Generalized Linear Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/merliseclyde/BAS/blob/main/R/bas_glm.R" class="external-link"><code>R/bas_glm.R</code></a></small>
      <div class="d-none name"><code>bas.glm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sample with or without replacement from a posterior distribution on GLMs</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bas.glm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">offset</span>,</span>
<span>  na.action <span class="op">=</span> <span class="st">"na.omit"</span>,</span>
<span>  n.models <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  betaprior <span class="op">=</span> <span class="fu"><a href="CCH.html">CCH</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  modelprior <span class="op">=</span> <span class="fu"><a href="beta.binomial.html">beta.binomial</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  initprobs <span class="op">=</span> <span class="st">"Uniform"</span>,</span>
<span>  include.always <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"MCMC"</span>,</span>
<span>  update <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bestmodel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prob.rw <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  MCMC.iterations <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.control.html" class="external-link">glm.control</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  laplace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  renormalize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  force.heredity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bigmem <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>generalized linear model formula for the full model with all
predictors, Y ~ X.  All code assumes that an intercept will be included in
each model.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>a description of the error distribution and link function for
exponential family; currently only `binomial()` with the logistic link and
`poisson()` and `Gamma()`with the log link are available.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data frame</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>optional vector of weights to be used in the fitting process.
May be missing in which case weights are 1.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>subset of data used in fitting</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>an optional list. See the contrasts.arg of `model.matrix.default()`.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>a priori known component to be included in the linear
predictor; by default 0.</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function which indicates what should happen when the data
contain NAs. The default is "na.omit".</p></dd>


<dt id="arg-n-models">n.models<a class="anchor" aria-label="anchor" href="#arg-n-models"></a></dt>
<dd><p>number of unique models to keep. If NULL, BAS will attempt
to enumerate unless p &gt; 35 or method="MCMC". For any of methods using MCMC
algorithms that sample with replacement, sampling will stop when the number
of iterations exceeds the min of 'n.models' or 'MCMC.iterations' and on exit
'n.models' is updated to reflect the unique number of models that have been
sampled.</p></dd>


<dt id="arg-betaprior">betaprior<a class="anchor" aria-label="anchor" href="#arg-betaprior"></a></dt>
<dd><p>Prior on coefficients for model coefficients (except
intercept).  Options include
<code><a href="g.prior.html">g.prior</a></code>,
<code><a href="CCH.html">CCH</a></code>,
<code><a href="robust.html">robust</a></code>,
<code><a href="intrinsic.html">intrinsic</a></code>,
<code><a href="beta.prime.html">beta.prime</a></code>,
<code><a href="EB.local.html">EB.local</a></code>,
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code>, and
<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></code>.</p></dd>


<dt id="arg-modelprior">modelprior<a class="anchor" aria-label="anchor" href="#arg-modelprior"></a></dt>
<dd><p>Family of prior distribution on the models.  Choices
include <code><a href="uniform.html">uniform</a></code>, <code><a href="Bernoulli.html">Bernoulli</a></code>,
<code><a href="beta.binomial.html">beta.binomial</a></code>, truncated Beta-Binomial,
<code><a href="tr.beta.binomial.html">tr.beta.binomial</a></code>, and truncated power family
<code><a href="tr.power.prior.html">tr.power.prior</a></code>.</p></dd>


<dt id="arg-initprobs">initprobs<a class="anchor" aria-label="anchor" href="#arg-initprobs"></a></dt>
<dd><p>vector of length p with the initial inclusion probabilities
used for sampling without replacement (the intercept will be included with
probability one and does not need to be added here) or a character string
giving the method used to construct the sampling probabilities if "Uniform"
each predictor variable is equally likely to be sampled (equivalent to
random sampling without replacement). If "eplogp", use the
<code><a href="eplogprob.html">eplogprob</a></code> function to approximate the Bayes factor using
p-values to find initial marginal inclusion probabilities and sample
without replacement using these inclusion probabilities, which may be
updated using estimates of the marginal inclusion probabilities. "eplogp"
assumes that MLEs from the full model exist; for problems where that is not
the case or 'p' is large, initial sampling probabilities may be obtained
using <code><a href="eplogprob.marg.html">eplogprob.marg</a></code> which fits a model to each predictor
separately.  To run a Markov Chain to provide initial
estimates of marginal inclusion probabilities, use method="MCMC+BAS" below.
While the initprobs are not used in sampling for method="MCMC", this
determines the order of the variables in the lookup table and affects memory
allocation in large problems where enumeration is not feasible.  For
variables that should always be included set the corresponding initprobs to
1, to override the `modelprior` or use `include.always` to force these variables
to always be included in the model.</p></dd>


<dt id="arg-include-always">include.always<a class="anchor" aria-label="anchor" href="#arg-include-always"></a></dt>
<dd><p>A formula with terms that should always be included
in the model with probability one.  By default this is `~ 1` meaning that the
intercept is always included.
This will also override any of the values in `initprobs`
above by setting them to 1.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A character variable indicating which sampling method to use:
method="BAS" uses Bayesian Adaptive Sampling (without replacement) using the
sampling probabilities given in initprobs and updates using the marginal
inclusion probabilities to direct the search/sample; method="MCMC" combines
a random walk Metropolis Hastings (as in MC3 of Raftery et al 1997) with a
random swap of a variable included with a variable that is currently
excluded (see Clyde, Ghosh, and Littman (2010) for details);
method="MCMC+BAS" runs an initial MCMC as above to calculate marginal
inclusion probabilities and then samples without replacement as in BAS;
method = "deterministic" runs an deterministic sampling using the initial
probabilities (no updating); this is recommended for fast enumeration or if a
model of independence is a good approximation to the joint posterior
distribution of the model indicators.  For BAS, the sampling probabilities
can be updated as more models are sampled. (see 'update' below).  We
recommend "MCMC+BAS" or "MCMC" for high dimensional problems.</p></dd>


<dt id="arg-update">update<a class="anchor" aria-label="anchor" href="#arg-update"></a></dt>
<dd><p>number of iterations between potential updates of the sampling
probabilities in the "BAS" method. If NULL do not update, otherwise the
algorithm will update using the marginal inclusion probabilities as they
change while sampling takes place.  For large model spaces, updating is
recommended. If the model space will be enumerated, leave at the default.</p></dd>


<dt id="arg-bestmodel">bestmodel<a class="anchor" aria-label="anchor" href="#arg-bestmodel"></a></dt>
<dd><p>optional binary vector representing a model to initialize
the sampling. If NULL sampling starts with the null model</p></dd>


<dt id="arg-prob-rw">prob.rw<a class="anchor" aria-label="anchor" href="#arg-prob-rw"></a></dt>
<dd><p>For any of the MCMC methods, probability of using the
random-walk proposal; otherwise use a random "flip" move to propose a new
model.</p></dd>


<dt id="arg-mcmc-iterations">MCMC.iterations<a class="anchor" aria-label="anchor" href="#arg-mcmc-iterations"></a></dt>
<dd><p>Number of models to sample when using any of the MCMC
options; should be greater than 'n.models'. By default 10*n.models.</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>oFr "MCMC", thin the MCMC chain every "thin" iterations; default
is no
thinning.  For large p, thinning can be used to significantly reduce memory
requirements as models and associated summaries are saved only every thin
iterations.  For thin = p, the  model and associated output are recorded
every p iterations,similar to the Gibbs sampler in SSVS.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list of parameters that control convergence in the fitting
process.  See the documentation for <code><a href="https://rdrr.io/r/stats/glm.control.html" class="external-link">glm.control()</a></code></p></dd>


<dt id="arg-laplace">laplace<a class="anchor" aria-label="anchor" href="#arg-laplace"></a></dt>
<dd><p>logical variable for whether to use a Laplace approximate for
integration with respect to g to obtain the marginal likelihood.  If FALSE
the Cephes library is used which may be inaccurate for large n or large
values of the Wald Chisquared statistic.</p></dd>


<dt id="arg-renormalize">renormalize<a class="anchor" aria-label="anchor" href="#arg-renormalize"></a></dt>
<dd><p>logical variable for whether posterior probabilities
should be based on renormalizing marginal likelihoods times prior
probabilities or use Monte Carlo frequencies. Applies only to MCMC sampling.</p></dd>


<dt id="arg-force-heredity">force.heredity<a class="anchor" aria-label="anchor" href="#arg-force-heredity"></a></dt>
<dd><p>Logical variable to force all levels of a factor to be
included together and to include higher order interactions only if lower
order terms are included.  Currently only supported with `method='MCMC'`
and `method='BAS'` (experimental) on non-Solaris platforms.
Default is FALSE.</p></dd>


<dt id="arg-bigmem">bigmem<a class="anchor" aria-label="anchor" href="#arg-bigmem"></a></dt>
<dd><p>Logical variable to indicate that there is access to
large amounts of memory (physical or virtual) for enumeration
with large model spaces, e.g. &gt; 2^25.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>bas.glm</code> returns an object of class <code>basglm</code></p>
<p>An object of class <code>basglm</code> is a list containing at least the following
components:</p>
<dl><dt>postprobs</dt>
<dd><p>the posterior probabilities of the models selected</p></dd>

<dt>priorprobs</dt>
<dd><p>the prior probabilities of the models selected</p></dd>

<dt>logmarg</dt>
<dd><p>values of the log of the marginal likelihood for the models</p></dd>

<dt>n.vars</dt>
<dd><p>total number of independent variables in the full model,
including the intercept</p></dd>

<dt>size</dt>
<dd><p>the number of independent variables in
each of the models, includes the intercept</p></dd>

<dt>which</dt>
<dd><p>a list of lists
with one list per model with variables that are included in the model</p></dd>

<dt>probne0</dt>
<dd><p>the posterior probability that each variable is non-zero</p></dd>

<dt>mle</dt>
<dd><p>list of lists with one list per model giving the GLM
estimate of each (nonzero) coefficient for each model.</p></dd>

<dt>mle.se</dt>
<dd><p>list of
lists with one list per model giving the GLM standard error of each
coefficient for each model</p></dd>

<dt>deviance</dt>
<dd><p>the GLM deviance for each model</p></dd>

<dt>modelprior</dt>
<dd><p>the prior distribution on models that created the BMA
object</p></dd>

<dt>Q</dt>
<dd><p>the Q statistic for each model used in the marginal
likelihood approximation</p></dd>

<dt>Y</dt>
<dd><p>response</p></dd>

<dt>X</dt>
<dd><p>matrix of predictors</p></dd>

<dt>family</dt>
<dd><p>family object from the original call</p></dd>

<dt>betaprior</dt>
<dd><p>family object for prior on coefficients, including
 hyperparameters</p></dd>

<dt>modelprior</dt>
<dd><p>family object for prior on the models</p></dd>

<dt>include.always</dt>
<dd><p>indices of variables that are forced into the model</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>BAS provides several search algorithms to find high probability models for
use in Bayesian Model Averaging or Bayesian model selection. For p less than
20-25, BAS can enumerate all models depending on memory availability, for
larger p, BAS samples without replacement using random or deterministic
sampling. The Bayesian Adaptive Sampling algorithm of Clyde, Ghosh, Littman
(2010) samples models without replacement using the initial sampling
probabilities, and will optionally update the sampling probabilities every
"update" models using the estimated marginal inclusion probabilities. BAS
uses different methods to obtain the <code>initprobs</code>, which may impact the
results in high-dimensional problems. The deterministic sampler provides a
list of the top models in order of an approximation of independence using
the provided <code>initprobs</code>.  This may be effective after running the
other algorithms to identify high probability models and works well if the
correlations of variables are small to modest.  The priors on coefficients
are mixtures of g-priors that provide approximations to the power prior.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Li, Y. and Clyde, M. (2018) Mixtures of g-priors in Generalized
Linear Models.
Journal of the American Statistical Association. 113:1828-1845 <br><a href="https://doi.org/10.1080/01621459.2018.1469992" class="external-link">doi:10.1080/01621459.2018.1469992</a>
 <br>
Clyde, M. Ghosh, J. and Littman, M. (2010) Bayesian Adaptive Sampling for
Variable Selection and Model Averaging. Journal of Computational Graphics
and Statistics.  20:80-101 <br><a href="https://doi.org/10.1198/jcgs.2010.09049" class="external-link">doi:10.1198/jcgs.2010.09049</a>
 <br>
Raftery, A.E, Madigan, D. and Hoeting, J.A. (1997) Bayesian Model Averaging
for Linear Regression Models. Journal of the American Statistical
Association.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Merlise Clyde (<a href="mailto:clyde@duke.edu">clyde@duke.edu</a>), Quanli Wang and Yingbo
Li</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Pima.tr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># enumeration  with default method="BAS"</span></span></span>
<span class="r-in"><span><span class="va">pima.cch</span> <span class="op">=</span> <span class="fu">bas.glm</span><span class="op">(</span><span class="va">type</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">Pima.tr</span>, n.models<span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>              method<span class="op">=</span><span class="st">"BAS"</span>,</span></span>
<span class="r-in"><span>              betaprior<span class="op">=</span><span class="fu"><a href="CCH.html">CCH</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span>, b<span class="op">=</span><span class="fl">532</span><span class="op">/</span><span class="fl">2</span>, s<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              modelprior<span class="op">=</span><span class="fu"><a href="beta.binomial.html">beta.binomial</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="summary.html">summary</a></span><span class="op">(</span><span class="va">pima.cch</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           P(B != 0 | Y)   model 1      model 2      model 3      model 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept     1.0000000    1.0000    1.0000000    1.0000000    1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> npreg         0.5684414    0.0000    1.0000000    1.0000000    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glu           0.9999949    1.0000    1.0000000    1.0000000    1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bp            0.2198720    0.0000    0.0000000    0.0000000    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> skin          0.2653924    0.0000    0.0000000    0.0000000    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bmi           0.7425039    1.0000    1.0000000    1.0000000    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ped           0.8860972    1.0000    1.0000000    1.0000000    1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age           0.7459954    1.0000    1.0000000    0.0000000    1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BF                   NA    1.0000    0.4406494    0.6209086    0.4628319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PostProbs            NA    0.1596    0.1172000    0.0991000    0.0739000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2                   NA    0.2938    0.3040000    0.2901000    0.2703000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim                  NA    5.0000    6.0000000    5.0000000    4.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logmarg              NA -101.7878 -102.6072611 -102.2643268 -102.5581467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 model 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept  1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> npreg      1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> glu        1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bp         1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> skin       1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bmi        1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ped        1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age        1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BF         8.659168e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PostProbs  4.840000e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R2         3.043000e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim        8.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logmarg   -1.065369e+02</span>
<span class="r-in"><span><span class="fu"><a href="image.bas.html">image</a></span><span class="op">(</span><span class="va">pima.cch</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bas.glm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note MCMC.iterations are set to 2500 for illustration purposes due to time</span></span></span>
<span class="r-in"><span><span class="co"># limitations for running examples on CRAN servers.</span></span></span>
<span class="r-in"><span><span class="co"># Please check convergence diagnostics and run longer in practice</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pima.robust</span> <span class="op">=</span> <span class="fu">bas.glm</span><span class="op">(</span><span class="va">type</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">Pima.tr</span>, n.models<span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>              method<span class="op">=</span><span class="st">"MCMC"</span>, MCMC.iterations<span class="op">=</span><span class="fl">2500</span>,</span></span>
<span class="r-in"><span>              betaprior<span class="op">=</span><span class="fu"><a href="robust.html">robust</a></span><span class="op">(</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              modelprior<span class="op">=</span><span class="fu"><a href="beta.binomial.html">beta.binomial</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pima.BIC</span> <span class="op">=</span> <span class="fu">bas.glm</span><span class="op">(</span><span class="va">type</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">Pima.tr</span>, n.models<span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>              method<span class="op">=</span><span class="st">"BAS+MCMC"</span>, MCMC.iterations<span class="op">=</span><span class="fl">2500</span>,</span></span>
<span class="r-in"><span>              betaprior<span class="op">=</span><span class="fu"><a href="IC.prior.html">bic.prior</a></span><span class="op">(</span><span class="op">)</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              modelprior<span class="op">=</span><span class="fu"><a href="uniform.html">uniform</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to min; returning Inf</span>
<span class="r-in"><span><span class="co"># Poisson example</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"glmbb"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">crabs</span>, package<span class="op">=</span><span class="st">'glmbb'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">#short run for illustration</span></span></span>
<span class="r-in"><span>  <span class="va">crabs.bas</span> <span class="op">=</span> <span class="fu">bas.glm</span><span class="op">(</span><span class="va">satell</span> <span class="op">~</span> <span class="va">color</span><span class="op">*</span><span class="va">spine</span><span class="op">*</span><span class="va">width</span> <span class="op">+</span> <span class="va">weight</span>, data<span class="op">=</span><span class="va">crabs</span>,</span></span>
<span class="r-in"><span>                      family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      betaprior<span class="op">=</span><span class="fu"><a href="EB.local.html">EB.local</a></span><span class="op">(</span><span class="op">)</span>, modelprior<span class="op">=</span><span class="fu"><a href="uniform.html">uniform</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      method<span class="op">=</span><span class="st">'MCMC'</span>, n.models<span class="op">=</span><span class="fl">2</span><span class="op">^</span><span class="fl">10</span>, MCMC.iterations<span class="op">=</span><span class="fl">2500</span>,</span></span>
<span class="r-in"><span>                      prob.rw<span class="op">=</span><span class="fl">.95</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span> <span class="co"># Gamma example</span></span></span>
<span class="r-in"><span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"faraway"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wafer</span>, package<span class="op">=</span><span class="st">'faraway'</span><span class="op">)</span></span></span>
<span class="r-in"><span>                      </span></span>
<span class="r-in"><span>    <span class="va">wafer_bas</span> <span class="op">=</span> <span class="fu">bas.glm</span><span class="op">(</span><span class="va">resist</span><span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">wafer</span>,  include.always <span class="op">=</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>                        betaprior <span class="op">=</span> <span class="fu"><a href="IC.prior.html">bic.prior</a></span><span class="op">(</span><span class="op">)</span> ,</span></span>
<span class="r-in"><span>                        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">Gamma</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://merliseclyde.github.io/personal-website/" class="external-link">Merlise Clyde</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

