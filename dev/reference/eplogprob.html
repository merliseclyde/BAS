<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>eplogprob - Compute approximate marginal inclusion probabilities from pvalues — eplogprob • BAS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="eplogprob - Compute approximate marginal inclusion probabilities from pvalues — eplogprob"><meta name="description" content="eplogprob calculates approximate marginal posterior inclusion
probabilities from p-values computed from a linear model using a lower bound
approximation to Bayes factors.  Used to obtain initial inclusion
probabilities for sampling using Bayesian Adaptive Sampling bas.lm"><meta property="og:description" content="eplogprob calculates approximate marginal posterior inclusion
probabilities from p-values computed from a linear model using a lower bound
approximation to Bayes factors.  Used to obtain initial inclusion
probabilities for sampling using Bayesian Adaptive Sampling bas.lm"><meta property="og:image" content="http://merliseclyde.github.io/BAS/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BAS</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.7.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/merliseclyde"><span class="fa fa-twitter"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/merliseclyde/BAS"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>eplogprob - Compute approximate marginal inclusion probabilities from pvalues</h1>
      <small class="dont-index">Source: <a href="https://github.com/merliseclyde/BAS/blob/main/R/eplogprob.R" class="external-link"><code>R/eplogprob.R</code></a></small>
      <div class="d-none name"><code>eplogprob.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>eplogprob</code> calculates approximate marginal posterior inclusion
probabilities from p-values computed from a linear model using a lower bound
approximation to Bayes factors.  Used to obtain initial inclusion
probabilities for sampling using Bayesian Adaptive Sampling <code>bas.lm</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eplogprob</span><span class="op">(</span><span class="va">lm.obj</span>, thresh <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">0.99</span>, int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-lm-obj">lm.obj<a class="anchor" aria-label="anchor" href="#arg-lm-obj"></a></dt>
<dd><p>a linear model object</p></dd>


<dt id="arg-thresh">thresh<a class="anchor" aria-label="anchor" href="#arg-thresh"></a></dt>
<dd><p>the value of the inclusion probability when if the p-value &gt;
1/exp(1), where the lower bound approximation is not valid.</p></dd>


<dt id="arg-max">max<a class="anchor" aria-label="anchor" href="#arg-max"></a></dt>
<dd><p>maximum value of the inclusion probability; used for the
<code>bas.lm</code> function to keep initial inclusion probabilities away from 1.</p></dd>


<dt id="arg-int">int<a class="anchor" aria-label="anchor" href="#arg-int"></a></dt>
<dd><p>If the Intercept is included in the linear model, set the
marginal inclusion probability corresponding to the intercept to 1</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>eplogprob</code> returns a vector of marginal posterior inclusion
probabilities for each of the variables in the linear model. If int = TRUE,
then the inclusion probability for the intercept is set to 1.  If the model
is not full rank, variables that are linearly dependent base on the QR
factorization will have NA for their p-values.  In bas.lm, where the
probabilities are used for sampling, the inclusion probability is set to 0.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Sellke, Bayarri and Berger (2001) provide a simple calibration of p-values</p>
<p>BF(p) = -e p log(p)</p>
<p>which provide a lower bound to a Bayes factor for comparing H0: beta = 0
versus H1: beta not equal to 0, when the p-value p is less than 1/e.  Using
equal prior odds on the hypotheses H0 and H1, the approximate marginal
posterior inclusion probability</p>
<p>p(beta != 0 | data ) = 1/(1 + BF(p))</p>
<p>When p &gt; 1/e, we set the marginal inclusion probability to 0.5 or the value
given by <code>thresh</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sellke, Thomas, Bayarri, M. J., and Berger, James O.  (2001),
“Calibration of p-values for testing precise null hypotheses”, The
American Statistician, 55, 62-71.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bas.lm.html">bas</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Merlise Clyde <a href="mailto:clyde@stat.duke.edu">clyde@stat.duke.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">UScrime</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">UScrime</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">UScrime</span><span class="op">[</span>,<span class="op">-</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">eplogprob</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">UScrime</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)           M          So          Ed         Po1         Po2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.0000000   0.9480823   0.5000000   0.9883193   0.5045770   0.5000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          LF         M.F         Pop          NW          U1          U2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.5000000   0.5304659   0.5807429   0.8046414   0.5000000   0.6858642 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         GDP        Ineq        Prob        Time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.6069289   0.9900000   0.9412475   0.5782754 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://merliseclyde.github.io/personal-website/" class="external-link">Merlise Clyde</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

