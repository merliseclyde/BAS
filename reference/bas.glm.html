<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian Adaptive Sampling Without Replacement for Variable Selection in
Generalized Linear Models — bas.glm • BAS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Bayesian Adaptive Sampling Without Replacement for Variable Selection in
Generalized Linear Models — bas.glm" />
<meta property="og:description" content="Sample with or without replacement from a posterior distribution on GLMs" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BAS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/merliseclyde">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/merliseclyde/BAS">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian Adaptive Sampling Without Replacement for Variable Selection in
Generalized Linear Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/merliseclyde/BAS/blob/master/R/bas_glm.R'><code>R/bas_glm.R</code></a></small>
    <div class="hidden name"><code>bas.glm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sample with or without replacement from a posterior distribution on GLMs</p>
    </div>

    <pre class="usage"><span class='fu'>bas.glm</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"logit"</span><span class='op'>)</span>,
  <span class='va'>data</span>,
  <span class='va'>weights</span>,
  <span class='va'>subset</span>,
  contrasts <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>offset</span>,
  na.action <span class='op'>=</span> <span class='st'>"na.omit"</span>,
  n.models <span class='op'>=</span> <span class='cn'>NULL</span>,
  betaprior <span class='op'>=</span> <span class='fu'><a href='CCH.html'>CCH</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span>, beta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span>, s <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
  modelprior <span class='op'>=</span> <span class='fu'><a href='beta.binomial.html'>beta.binomial</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
  initprobs <span class='op'>=</span> <span class='st'>"Uniform"</span>,
  include.always <span class='op'>=</span> <span class='op'>~</span><span class='fl'>1</span>,
  method <span class='op'>=</span> <span class='st'>"MCMC"</span>,
  update <span class='op'>=</span> <span class='cn'>NULL</span>,
  bestmodel <span class='op'>=</span> <span class='cn'>NULL</span>,
  prob.rw <span class='op'>=</span> <span class='fl'>0.5</span>,
  MCMC.iterations <span class='op'>=</span> <span class='cn'>NULL</span>,
  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.control.html'>glm.control</a></span><span class='op'>(</span><span class='op'>)</span>,
  laplace <span class='op'>=</span> <span class='cn'>FALSE</span>,
  renormalize <span class='op'>=</span> <span class='cn'>FALSE</span>,
  force.heredity <span class='op'>=</span> <span class='cn'>FALSE</span>,
  bigmem <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>generalized linear model formula for the full model with all
predictors, Y ~ X.  All code assumes that an intercept will be included in
each model.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>a description of the error distribution and link function for
exponential family; currently only `binomial()` with the logistic link and
`poisson()` with the log link are available.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>optional vector of weights to be used in the fitting process.
May be missing in which case weights are 1.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>subset of data used in fitting</p></td>
    </tr>
    <tr>
      <th>contrasts</th>
      <td><p>an optional list. See the contrasts.arg of `model.matrix.default()`.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>a priori known component to be included in the linear
predictor; by default 0.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function which indicates what should happen when the data
contain NAs. The default is "na.omit".</p></td>
    </tr>
    <tr>
      <th>n.models</th>
      <td><p>number of unique models to keep. If NULL, BAS will attempt
to enumerate unless p &gt; 35 or method="MCMC". For any of methods using MCMC
algorithms that sample with replacement, sampling will stop when the number
of iterations exceeds the min of 'n.models' or 'MCMC.iterations' and on exit
'n.models' is updated to reflect the unique number of models that have been
sampled.</p></td>
    </tr>
    <tr>
      <th>betaprior</th>
      <td><p>Prior on coefficients for model coefficients (except
intercept).  Options include <code><a href='g.prior.html'>g.prior</a></code>, <code><a href='CCH.html'>CCH</a></code>,
<code><a href='robust.html'>robust</a></code>, <code><a href='intrinsic.html'>intrinsic</a></code>, <code><a href='beta.prime.html'>beta.prime</a></code>,
<code><a href='EB.local.html'>EB.local</a></code>, <code><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></code>, and <code><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></code>.</p></td>
    </tr>
    <tr>
      <th>modelprior</th>
      <td><p>Family of prior distribution on the models.  Choices
include <code><a href='uniform.html'>uniform</a></code>, <code><a href='Bernoulli.html'>Bernoulli</a></code>,
<code><a href='beta.binomial.html'>beta.binomial</a></code>, truncated Beta-Binomial,
<code><a href='tr.beta.binomial.html'>tr.beta.binomial</a></code>, and truncated power family
<code><a href='tr.power.prior.html'>tr.power.prior</a></code>.</p></td>
    </tr>
    <tr>
      <th>initprobs</th>
      <td><p>vector of length p with the initial inclusion probabilities
used for sampling without replacement (the intercept will be included with
probability one and does not need to be added here) or a character string
giving the method used to construct the sampling probabilities if "Uniform"
each predictor variable is equally likely to be sampled (equivalent to
random sampling without replacement). If "eplogp", use the
<code><a href='eplogprob.html'>eplogprob</a></code> function to approximate the Bayes factor using
p-values to find initial marginal inclusion probabilities and sample
without replacement using these inclusion probabilities, which may be
updated using estimates of the marginal inclusion probabilities. "eplogp"
assumes that MLEs from the full model exist; for problems where that is not
the case or 'p' is large, initial sampling probabilities may be obtained
using <code><a href='eplogprob.marg.html'>eplogprob.marg</a></code> which fits a model to each predictor
separately.  To run a Markov Chain to provide initial
estimates of marginal inclusion probabilities, use method="MCMC+BAS" below.
While the initprobs are not used in sampling for method="MCMC", this
determines the order of the variables in the lookup table and affects memory
allocation in large problems where enumeration is not feasible.  For
variables that should always be included set the corresponding initprobs to
1, to override the `modelprior` or use `include.always` to force these variables
to always be included in the model.</p></td>
    </tr>
    <tr>
      <th>include.always</th>
      <td><p>A formula with terms that should always be included
in the model with probability one.  By default this is `~ 1` meaning that the
intercept is always included.  This will also override any of the values in `initprobs`
above by setting them to 1.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A character variable indicating which sampling method to use:
method="BAS" uses Bayesian Adaptive Sampling (without replacement) using the
sampling probabilities given in initprobs and updates using the marginal
inclusion probabilities to direct the search/sample; method="MCMC" combines
a random walk Metropolis Hastings (as in MC3 of Raftery et al 1997) with a
random swap of a variable included with a variable that is currently
excluded (see Clyde, Ghosh, and Littman (2010) for details);
method="MCMC+BAS" runs an initial MCMC as above to calculate marginal
inclusion probabilities and then samples without replacement as in BAS;
method = "deterministic" runs an deterministic sampling using the initial
probabilities (no updating); this is recommended for fast enumeration or if a
model of independence is a good approximation to the joint posterior
distribution of the model indicators.  For BAS, the sampling probabilities
can be updated as more models are sampled. (see 'update' below).  We
recommend "MCMC+BAS" or "MCMC" for high dimensional problems.</p></td>
    </tr>
    <tr>
      <th>update</th>
      <td><p>number of iterations between potential updates of the sampling
probabilities in the "BAS" method. If NULL do not update, otherwise the
algorithm will update using the marginal inclusion probabilities as they
change while sampling takes place.  For large model spaces, updating is
recommended. If the model space will be enumerated, leave at the default.</p></td>
    </tr>
    <tr>
      <th>bestmodel</th>
      <td><p>optional binary vector representing a model to initialize
the sampling. If NULL sampling starts with the null model</p></td>
    </tr>
    <tr>
      <th>prob.rw</th>
      <td><p>For any of the MCMC methods, probability of using the
random-walk proposal; otherwise use a random "flip" move to propose a new
model.</p></td>
    </tr>
    <tr>
      <th>MCMC.iterations</th>
      <td><p>Number of models to sample when using any of the MCMC
options; should be greater than 'n.models'. By default 10*n.models.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of parameters that control convergence in the fitting
process.  See the documentation for <code><a href='https://rdrr.io/r/stats/glm.control.html'>glm.control()</a></code></p></td>
    </tr>
    <tr>
      <th>laplace</th>
      <td><p>logical variable for whether to use a Laplace approximate for
integration with respect to g to obtain the marginal likelihood.  If FALSE
the Cephes library is used which may be inaccurate for large n or large
values of the Wald Chisquared statistic.</p></td>
    </tr>
    <tr>
      <th>renormalize</th>
      <td><p>logical variable for whether posterior probabilities
should be based on renormalizing marginal likelihoods times prior
probabilities or use Monte Carlo frequencies. Applies only to MCMC sampling.</p></td>
    </tr>
    <tr>
      <th>force.heredity</th>
      <td><p>Logical variable to force all levels of a factor to be
included together and to include higher order interactions only if lower
order terms are included.  Currently only supported with `method='MCMC'`
and `method='BAS'` (experimental) on non-Solaris platforms.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>bigmem</th>
      <td><p>Logical variable to indicate that there is access to
large amounts of memory (physical or virtual) for enumeration
with large model spaces, e.g. &gt; 2^25.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>bas.glm</code> returns an object of class <code>basglm</code></p>
<p>An object of class <code>basglm</code> is a list containing at least the following
components:</p>
<dt>postprobs</dt><dd><p>the posterior probabilities of the models selected</p></dd>
<dt>priorprobs</dt><dd><p>the prior probabilities of the models selected</p></dd>
<dt>logmarg</dt><dd><p>values of the log of the marginal likelihood for the models</p></dd>
<dt>n.vars</dt><dd><p>total number of independent variables in the full model,
including the intercept</p></dd>
<dt>size</dt><dd><p>the number of independent variables in
each of the models, includes the intercept</p></dd>
<dt>which</dt><dd><p>a list of lists
with one list per model with variables that are included in the model</p></dd>
<dt>probne0</dt><dd><p>the posterior probability that each variable is non-zero</p></dd>
<dt>coefficients</dt><dd><p>list of lists with one list per model giving the GLM
estimate of each (nonzero) coefficient for each model.</p></dd>
<dt>se</dt><dd><p>list of
lists with one list per model giving the GLM standard error of each
coefficient for each model</p></dd>
<dt>deviance</dt><dd><p>the GLM deviance for each model</p></dd>
<dt>modelprior</dt><dd><p>the prior distribution on models that created the BMA
object</p></dd>
<dt>Q</dt><dd><p>the Q statistic for each model used in the marginal
likelihood approximation</p></dd>
<dt>Y</dt><dd><p>response</p></dd>
<dt>X</dt><dd><p>matrix of predictors</p></dd>
<dt>family</dt><dd><p>family object from the original call</p></dd>
<dt>betaprior</dt><dd><p>family
object for prior on coefficients, including hyperparameters</p></dd>
<dt>modelprior</dt><dd><p>family object for prior on the models</p></dd>
<dt>include.always</dt><dd><p>indices of variables that are forced into the model</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>BAS provides several search algorithms to find high probability models for
use in Bayesian Model Averaging or Bayesian model selection. For p less than
20-25, BAS can enumerate all models depending on memory availability, for
larger p, BAS samples without replacement using random or deterministic
sampling. The Bayesian Adaptive Sampling algorithm of Clyde, Ghosh, Littman
(2010) samples models without replacement using the initial sampling
probabilities, and will optionally update the sampling probabilities every
"update" models using the estimated marginal inclusion probabilities. BAS
uses different methods to obtain the <code>initprobs</code>, which may impact the
results in high-dimensional problems. The deterministic sampler provides a
list of the top models in order of an approximation of independence using
the provided <code>initprobs</code>.  This may be effective after running the
other algorithms to identify high probability models and works well if the
correlations of variables are small to modest.  The priors on coefficients
are mixtures of g-priors that provide approximations to the power prior.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Li, Y. and Clyde, M. (2018) Mixtures of g-priors in Generalized
Linear Models. Journal of the American Statistical Association. 113:1828-1845 <br />
doi: <a href='https://doi.org/10.1080/01621459.2018.1469992'>10.1080/01621459.2018.1469992</a>
 <br />
Clyde, M. Ghosh, J. and Littman, M. (2010) Bayesian Adaptive Sampling for
Variable Selection and Model Averaging. Journal of Computational Graphics
and Statistics.  20:80-101 <br />
doi: <a href='https://doi.org/10.1198/jcgs.2010.09049'>10.1198/jcgs.2010.09049</a>
 <br />
Raftery, A.E, Madigan, D. and Hoeting, J.A. (1997) Bayesian Model Averaging
for Linear Regression Models. Journal of the American Statistical
Association.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Merlise Clyde (<a href='mailto:clyde@duke.edu'>clyde@duke.edu</a>), Quanli Wang and Yingbo
Li</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Pima.tr</span>, package<span class='op'>=</span><span class='st'>"MASS"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># enumeration  with default method="BAS"</span></span>
<span class='r-in'><span class='va'>pima.cch</span> <span class='op'>=</span> <span class='fu'>bas.glm</span><span class='op'>(</span><span class='va'>type</span> <span class='op'>~</span> <span class='va'>.</span>, data<span class='op'>=</span><span class='va'>Pima.tr</span>, n.models<span class='op'>=</span> <span class='fl'>2</span><span class='op'>^</span><span class='fl'>7</span>,</span>
<span class='r-in'>              method<span class='op'>=</span><span class='st'>"BAS"</span>,</span>
<span class='r-in'>              betaprior<span class='op'>=</span><span class='fu'><a href='CCH.html'>CCH</a></span><span class='op'>(</span>a<span class='op'>=</span><span class='fl'>1</span>, b<span class='op'>=</span><span class='fl'>532</span><span class='op'>/</span><span class='fl'>2</span>, s<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>, family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span class='r-in'>              modelprior<span class='op'>=</span><span class='fu'><a href='beta.binomial.html'>beta.binomial</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='summary.bas.html'>summary</a></span><span class='op'>(</span><span class='va'>pima.cch</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>           P(B != 0 | Y)   model 1      model 2      model 3      model 4</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Intercept     1.0000000    1.0000    1.0000000    1.0000000    1.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> npreg         0.5684414    0.0000    1.0000000    1.0000000    0.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> glu           0.9999949    1.0000    1.0000000    1.0000000    1.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> bp            0.2198720    0.0000    0.0000000    0.0000000    0.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> skin          0.2653924    0.0000    0.0000000    0.0000000    0.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> bmi           0.7425039    1.0000    1.0000000    1.0000000    0.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ped           0.8860972    1.0000    1.0000000    1.0000000    1.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> age           0.7459954    1.0000    1.0000000    0.0000000    1.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> BF                   NA    1.0000    0.4406494    0.6209086    0.4628319</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> PostProbs            NA    0.1596    0.1172000    0.0991000    0.0739000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> R2                   NA    0.2938    0.3040000    0.2901000    0.2703000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> dim                  NA    5.0000    6.0000000    5.0000000    4.0000000</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> logmarg              NA -101.7878 -102.6072611 -102.2643268 -102.5581467</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                 model 5</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Intercept  1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> npreg      1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> glu        1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> bp         1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> skin       1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> bmi        1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ped        1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> age        1.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> BF         8.659168e-03</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> PostProbs  4.840000e-02</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> R2         3.043000e-01</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> dim        8.000000e+00</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> logmarg   -1.065369e+02</span>
<span class='r-in'><span class='fu'><a href='image.bas.html'>image</a></span><span class='op'>(</span><span class='va'>pima.cch</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='bas.glm-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Note MCMC.iterations are set to 1000 for illustration purposes</span></span>
<span class='r-in'><span class='co'># Please check convergence diagnostics and run longer in practice</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>pima.robust</span> <span class='op'>=</span> <span class='fu'>bas.glm</span><span class='op'>(</span><span class='va'>type</span> <span class='op'>~</span> <span class='va'>.</span>, data<span class='op'>=</span><span class='va'>Pima.tr</span>, n.models<span class='op'>=</span> <span class='fl'>2</span><span class='op'>^</span><span class='fl'>7</span>,</span>
<span class='r-in'>              method<span class='op'>=</span><span class='st'>"MCMC"</span>, MCMC.iterations<span class='op'>=</span><span class='fl'>5000</span>,</span>
<span class='r-in'>              betaprior<span class='op'>=</span><span class='fu'><a href='robust.html'>robust</a></span><span class='op'>(</span><span class='op'>)</span>, family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span class='r-in'>              modelprior<span class='op'>=</span><span class='fu'><a href='beta.binomial.html'>beta.binomial</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>pima.BIC</span> <span class='op'>=</span> <span class='fu'>bas.glm</span><span class='op'>(</span><span class='va'>type</span> <span class='op'>~</span> <span class='va'>.</span>, data<span class='op'>=</span><span class='va'>Pima.tr</span>, n.models<span class='op'>=</span> <span class='fl'>2</span><span class='op'>^</span><span class='fl'>7</span>,</span>
<span class='r-in'>              method<span class='op'>=</span><span class='st'>"BAS+MCMC"</span>, MCMC.iterations<span class='op'>=</span><span class='fl'>5000</span>,</span>
<span class='r-in'>              betaprior<span class='op'>=</span><span class='fu'><a href='IC.prior.html'>bic.prior</a></span><span class='op'>(</span><span class='op'>)</span>, family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span class='r-in'>              modelprior<span class='op'>=</span><span class='fu'><a href='uniform.html'>uniform</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Poisson example</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>crabs</span>, package<span class='op'>=</span><span class='st'>"BAS"</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='co'>#short run for illustration</span></span>
<span class='r-in'>  <span class='va'>crabs.bas</span> <span class='op'>=</span> <span class='fu'>bas.glm</span><span class='op'>(</span><span class='va'>satell</span> <span class='op'>~</span> <span class='va'>color</span><span class='op'>*</span><span class='va'>spine</span><span class='op'>*</span><span class='va'>width</span> <span class='op'>+</span> <span class='va'>weight</span>,</span>
<span class='r-in'>                      data<span class='op'>=</span><span class='va'>crabs</span>,</span>
<span class='r-in'>                      family<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span class='r-in'>                      betaprior<span class='op'>=</span><span class='fu'><a href='EB.local.html'>EB.local</a></span><span class='op'>(</span><span class='op'>)</span>, modelprior<span class='op'>=</span><span class='fu'><a href='uniform.html'>uniform</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span class='r-in'>                      method<span class='op'>=</span><span class='st'>'MCMC'</span>, n.models<span class='op'>=</span><span class='fl'>2</span><span class='op'>^</span><span class='fl'>10</span>, MCMC.iterations<span class='op'>=</span><span class='fl'>5000</span>,</span>
<span class='r-in'>                      prob.rw<span class='op'>=</span><span class='fl'>.95</span><span class='op'>)</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://stat.duke.edu/~clyde'>Merlise Clyde</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '94a8229a313e5475acdeffd26558ce98',
    indexName: 'bas',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


